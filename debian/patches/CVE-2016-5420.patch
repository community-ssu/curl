From: Markus Koschany <apo@debian.org>
Date: Thu, 4 Aug 2016 11:33:57 +0200
Subject: CVE-2016-5420

Fix Re-using connection with wrong client cert.

Origin: https://curl.haxx.se/CVE-2016-5420.patch
---
 lib/sslgen.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/lib/sslgen.c b/lib/sslgen.c
index 6f19793..a143b72 100644
--- a/lib/sslgen.c
+++ b/lib/sslgen.c
@@ -90,6 +90,7 @@ Curl_ssl_config_matches(struct ssl_config_data* data,
      (data->verifyhost == needle->verifyhost) &&
      safe_strequal(data->CApath, needle->CApath) &&
      safe_strequal(data->CAfile, needle->CAfile) &&
+     safe_strequal(data->clientcert, needle->clientcert) &&
      safe_strequal(data->random_file, needle->random_file) &&
      safe_strequal(data->egdsocket, needle->egdsocket) &&
      safe_strequal(data->cipher_list, needle->cipher_list))
